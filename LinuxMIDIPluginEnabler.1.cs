'From MIT Squeak 0.9.4 (June 1, 2003) [No updates present.] on 21 July 2014 at 1:04:39 am'!!ScratchStageMorph methodsFor: 'midi' stamp: 'ka 7/21/2014 01:01'!tryToOpenMidiPort	"Attempt to open the MIDI port. First try the port selected by the user, if any. If that port number is not a MIDI output port, try to find another port number. If all measures fail, leave midiPort set to nil."	| possiblePorts dir portNum |	"Smalltalk isUnix ifTrue: [midiPort _ nil. ^ self]."	possiblePorts _ (0 to: SimpleMIDIPort primPortCount - 1) select: [:i |		dir _ SimpleMIDIPort primPortDirectionalityOf: i.		(dir = 2) | (dir = 3)].  "out or in/out port"	possiblePorts size = 0 ifTrue: [midiPort _ nil. ^ self].  "no midi ports"	(possiblePorts includes: midiPortNum)		ifTrue: [portNum _ midiPortNum]  "use the port requested by the user"		ifFalse: [portNum _ possiblePorts first].  "use the first available port"				[midiPort _ SimpleMIDIPort openOnPortNumber: portNum] ifError: [midiPort _ nil].! !